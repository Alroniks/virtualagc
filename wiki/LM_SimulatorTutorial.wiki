#summary LM Simulator Tutorial

http://virtualagc.googlecode.com/svn/trunk/Apollo32.png 
= 1. LM Simulator Tutorial =

This tutorial is intended to get you started with the AGC running in LGC (Lunar Guidance Computer) mode in conjunction with the virtual static simulator (developed by Stephan Hotto). Running the AGC in LGC mode  means that the AGC is configured to operate for conditions suitable for the Lunar Module. To do this you must run the yaAGC emulator with the option --cfg=<your_path>/LM.ini
The LM_Simulator itself is a so called "plant" model of the Apollo Lunar Module which simulates the hardware around the LGC.

== 1.1 Requirements ==

Since the LM Simulator is written in Tcl/Tk you must have both the tcl and tk packages installed for Linux and the free distribution of [http://www.activestate.com/Products/activetcl/index.mhtml ActiveTcl] package for Windows. The simulator has been tested with Tcl version 8.4.
 
== 1.2 Starting the Simulation ==
To start the simulation you must first launch the AGC emulator running the Luminary131 code from MIT. The emulator must be forced into the LGC mode as previously discussed to avoid getting the yaAGC debug terminal due to an opcode trap that avoids infinite loops. Use the proper configuration option to select the LM mode.

Once the LGC is running you can optionally start the yaACA (Attitude Control Assembly) to control the Lunar Module with your joystick. The ACA capability is currently only available on Linux. To start the simulator simply run:
{{{
wish lm_simulator.tcl lm_simulator.ini 
}}}
If the specified configuration file cannot be found the simulator will assume the LM-7 mission configuration.

== 1.3 Simulator Layout ==
The simulator has 5 main areas of concern each of which is represented with its own window:
   * The computer keyboard and display interface also known as the DSKY
   * The LGC outputs for monitoring and correlating the AGC binary actuators
   * The LGC inputs to simulate the binary AGC sensors
   * The crew inputs to simulate the buttons, RHC/ACA and THC connected to the LGC
   * The Flight Director Attitude Indicator (FDAI) showing the LM attitude in relation to the Inertial Measurement Unit (IMU)

== 1.4 Taking Control ==
The following sections describe some simple steps to interact with the simulator and the DSKY to test and operate the LGC like a member of the Apollo crew. The subsections here will introduce the basic operation and control of the IMU as well as the Digital Auto Pilot (DAP).

=== 1.4.1 Quick Start ===
If you want to do a real fast startup without doing 0.1 to 1.4 then you should execute the following steps:
   * Switch the DAP to "ATTITUDE HOLD MODE ON" (AGC Crew Inputs)
   * Wait until "DRIVE CDU Z to X" goes on (AGC Outputs)
   * Type into the DSKY: V37E 00E (VERB 37 ENTR 00 ENTR) to send the AGC into the idle loop
   * DSKY: V77E (Normal DAP Mode) or V76E (Minimum Impulse Mode)
   * DSKY: V37E 00E to be sure that the AGC is in the idle mode
 
Now the vessel can be controlled by the RHC (Rotational Hand Controller) which can be found within the AGC Crew Inputs window.

=== 1.4.2 IMU operations === 

==== 1.4.2.1 AGC/LGC Initialization ====
After a fresh AGC start there is a need to do a reset by typing V36E. To go into the idle loop it is necessary to change the program by V37E 00E. Probably that has to be repeated a couple of times until "PROG" shows 00.
 
==== 1.4.2.2 IMU Basics ====
The IMU is constructed of a navigational platform gimbaled by a three axis system and a stable platform mounted on the inner gimbal to measure changes in velocity along the three axis.

The following mapping is valid after setting the IMU to zero degrees.
|| *Axis* || *Gimbal* || *Controls* ||
|| X      || Outer    || Yaw        ||
|| Y      || Inner    || Pitch      ||
|| Z      || Middle   || Roll       ||

A Gimbal-Lock Warning will be alerted when the Roll exceeds +/-70 Degrees
 
==== 1.4.2.3 IMU Start ====
After a fresh start of yaAGC and LM Simulator the AGC assumes an aligned IMU.
That means that the steps 1.1 to 1.4 are not urgently necessary if you want to do a fast start.
 
   * AGC Crew Inputs: Set "ISS TURN ON REQUESTED" to ON
   * Wait for about 90 sec until the DSKY "NO ATT" signal goes off
 
==== 1.4.2.4 IMU Pre-flight Checkout ====
Pre-flight check-out of the FDAI display interface -> DSKY: V43E
All values should be set to +00000.
 
==== 1.4.2.5  IMU Coarse Align ====
   * Type the following sequence into the DSKY: V41N20E (V = VERB; N = NOUN; E = ENTR)
   * Now the AGC asks for the angles in the format 000.00 Deg. The sequence is X, Y, Z. Don't forget the "+" or "-" sign!
   * The AGC drives the IMU to the absolute position given
   * Use the "FDAI/IMU" window to control the angle changes
 
==== 1.4.2.6  IMU Fine Align ====
After IMU Coarse Align the "NO ATT" light indicates that the platform is not completely aligned.
To finalize the alignment the following procedure is needed:
   * DSKY: V42E
   * Give the relative angles in format 00.000 Deg (e.g. three times +00000)
 
==== 1.4.2.7  Zero IMU ====
Here are three possible scenarios to reset the IMU to zero degrees:
   # AGC Crew Inputs => Activate: "IMU CAGE COMMAND TO DRIVE IMU GIMBAL ANGLES TO 0"
   # DSKY: V40N20E (AGC sends ZERO CAGE COMMAND)
   # DSKY: V36E (AGC RESET which automatically resets the IMU)
 
==== 1.4.2.8  Monitor IMU Values ====
Monitor Gimbal Angles DSKY: V16N20E
Monitor PIPA Counter Values: DSKY: V16N21E